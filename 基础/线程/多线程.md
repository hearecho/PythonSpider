# 多线程-Python

####线程和进程

1. 一个进程里面有多个线程，其中必包含一个主线程。进程相当于是一个应用程序。线程必须依赖于进程，线程就是cpu一个基础的执行单元。一个线程是一个**execution context（执行上下文）**，即一个 CPU 执行时所需要的一串指令。 
2. 区别:
   - 线程肯定依赖于进程运行
   - 进程可以包含很多线程，但是必有也仅有一个进程
   - 多线程共享同个地址空间、打开的文件以及其他资源。
   - 多进程共享物理内存、磁盘、打印机以及其他资源。
3. 线程的类型:
   - 主线程（肯定有，启动进程就会被创建）
   - 子线程 （一般可以看做调用的函数）
   - 守护线程（后台线程）
   - 前台线程

#### python多线程最大的坑爹处:

1. 由于GIL锁的存在，python中的多线程只能同时有一个线程执行。

   > GIL锁:全称是 Global Interpreter Lock(全局解释器锁)，来源是 Python 设计之初的考虑，为了数据安全所做的决定。某个线程想要执行，必须先拿到 GIL，我们可以把 GIL 看作是“通行证”，并且在一个 Python 进程中，GIL 只有一个。拿不到通行证的线程，就不允许进入 CPU 执行。
   >
   > GIL锁只有在  官方解释器CPython才有，而在 PyPy，Jython中是木有的

2. 运用多线程时间更长的原因:**每次释放 GIL锁，线程进行锁竞争、切换线程，会消耗资源。这就导致打印线程执行时长，会发现耗时更长的原因。**

#### 选择

- CPU 密集型：程序比较偏重于计算，需要经常使用 CPU 来运算。例如科学计算的程序，机器学习的程序等。
- I/O 密集型：顾名思义就是程序需要频繁进行输入输出操作。爬虫程序就是典型的 I/O 密集型程序。

*如果程序是属于 CPU 密集型，建议使用多线程。而多进程就更适合应用于 I/O 密集型程序* 